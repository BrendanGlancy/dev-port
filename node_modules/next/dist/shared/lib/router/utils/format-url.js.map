{"version":3,"sources":["../../../../../shared/lib/router/utils/format-url.ts"],"sourcesContent":["// Format function modified from nodejs\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nimport { UrlObject } from 'url'\nimport { ParsedUrlQuery } from 'querystring'\nimport * as querystring from './querystring'\n\nconst slashedProtocols = /https?|ftp|gopher|file/\n\nexport function formatUrl(urlObj: UrlObject) {\n  let { auth, hostname } = urlObj\n  let protocol = urlObj.protocol || ''\n  let pathname = urlObj.pathname || ''\n  let hash = urlObj.hash || ''\n  let query = urlObj.query || ''\n  let host: string | false = false\n\n  auth = auth ? encodeURIComponent(auth).replace(/%3A/i, ':') + '@' : ''\n\n  if (urlObj.host) {\n    host = auth + urlObj.host\n  } else if (hostname) {\n    host = auth + (~hostname.indexOf(':') ? `[${hostname}]` : hostname)\n    if (urlObj.port) {\n      host += ':' + urlObj.port\n    }\n  }\n\n  if (query && typeof query === 'object') {\n    query = String(querystring.urlQueryToSearchParams(query as ParsedUrlQuery))\n  }\n\n  let search = urlObj.search || (query && `?${query}`) || ''\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':'\n\n  if (\n    urlObj.slashes ||\n    ((!protocol || slashedProtocols.test(protocol)) && host !== false)\n  ) {\n    host = '//' + (host || '')\n    if (pathname && pathname[0] !== '/') pathname = '/' + pathname\n  } else if (!host) {\n    host = ''\n  }\n\n  if (hash && hash[0] !== '#') hash = '#' + hash\n  if (search && search[0] !== '?') search = '?' + search\n\n  pathname = pathname.replace(/[?#]/g, encodeURIComponent)\n  search = search.replace('#', '%23')\n\n  return `${protocol}${host}${pathname}${search}${hash}`\n}\n"],"names":[],"mappings":";;;;QA4BgB,SAAS,GAAT,SAAS;AAJb,GAAW,CAAX,WAAW;;;;;;;;;;;;;;;;;;;;;;;;AAEvB,KAAK,CAAC,gBAAgB;SAEN,SAAS,CAAC,MAAiB,EAAE,CAAC;IAC5C,GAAG,GAAG,IAAI,GAAE,QAAQ,MAAK,MAAM;IAC/B,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ;IAC9B,GAAG,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ;IAC9B,GAAG,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI;IACtB,GAAG,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK;IACxB,GAAG,CAAC,IAAI,GAAmB,KAAK;IAEhC,IAAI,GAAG,IAAI,GAAG,kBAAkB,CAAC,IAAI,EAAE,OAAO,UAAS,CAAG,MAAI,CAAG;IAEjE,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE,CAAC;QAChB,IAAI,GAAG,IAAI,GAAG,MAAM,CAAC,IAAI;IAC3B,CAAC,MAAM,EAAE,EAAE,QAAQ,EAAE,CAAC;QACpB,IAAI,GAAG,IAAI,KAAK,QAAQ,CAAC,OAAO,EAAC,CAAG,MAAK,CAAC,EAAE,QAAQ,CAAC,CAAC,IAAI,QAAQ;QAClE,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE,CAAC;YAChB,IAAI,KAAI,CAAG,IAAG,MAAM,CAAC,IAAI;QAC3B,CAAC;IACH,CAAC;IAED,EAAE,EAAE,KAAK,WAAW,KAAK,MAAK,MAAQ,GAAE,CAAC;QACvC,KAAK,GAAG,MAAM,CAxBN,WAAW,CAwBQ,sBAAsB,CAAC,KAAK;IACzD,CAAC;IAED,GAAG,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,IAAK,KAAK,KAAK,CAAC,EAAE,KAAK;IAEjD,EAAE,EAAE,QAAQ,IAAI,QAAQ,CAAC,MAAM,EAAE,CAAC,OAAM,CAAG,GAAE,QAAQ,KAAI,CAAG;IAE5D,EAAE,EACA,MAAM,CAAC,OAAO,MACX,QAAQ,IAAI,gBAAgB,CAAC,IAAI,CAAC,QAAQ,MAAM,IAAI,KAAK,KAAK,EACjE,CAAC;QACD,IAAI,IAAG,EAAI,KAAI,IAAI;QACnB,EAAE,EAAE,QAAQ,IAAI,QAAQ,CAAC,CAAC,OAAM,CAAG,GAAE,QAAQ,IAAG,CAAG,IAAG,QAAQ;IAChE,CAAC,MAAM,EAAE,GAAG,IAAI,EAAE,CAAC;QACjB,IAAI;IACN,CAAC;IAED,EAAE,EAAE,IAAI,IAAI,IAAI,CAAC,CAAC,OAAM,CAAG,GAAE,IAAI,IAAG,CAAG,IAAG,IAAI;IAC9C,EAAE,EAAE,MAAM,IAAI,MAAM,CAAC,CAAC,OAAM,CAAG,GAAE,MAAM,IAAG,CAAG,IAAG,MAAM;IAEtD,QAAQ,GAAG,QAAQ,CAAC,OAAO,UAAU,kBAAkB;IACvD,MAAM,GAAG,MAAM,CAAC,OAAO,EAAC,CAAG,IAAE,GAAK;cAExB,QAAQ,GAAG,IAAI,GAAG,QAAQ,GAAG,MAAM,GAAG,IAAI;AACtD,CAAC"}