{"version":3,"sources":["../../telemetry/anonymous-meta.ts"],"sourcesContent":["import isDockerFunction from 'next/dist/compiled/is-docker'\nimport isWslBoolean from 'next/dist/compiled/is-wsl'\nimport os from 'os'\n\nimport * as ciEnvironment from './ci-info'\n\ntype AnonymousMeta = {\n  systemPlatform: NodeJS.Platform\n  systemRelease: string\n  systemArchitecture: string\n  cpuCount: number\n  cpuModel: string | null\n  cpuSpeed: number | null\n  memoryInMb: number\n  isDocker: boolean\n  isNowDev: boolean\n  isWsl: boolean\n  isCI: boolean\n  ciName: string | null\n  nextVersion: string\n}\n\nlet traits: AnonymousMeta | undefined\n\nexport function getAnonymousMeta(): AnonymousMeta {\n  if (traits) {\n    return traits\n  }\n\n  const cpus = os.cpus() || []\n  const { NOW_REGION } = process.env\n  traits = {\n    // Software information\n    systemPlatform: os.platform(),\n    systemRelease: os.release(),\n    systemArchitecture: os.arch(),\n    // Machine information\n    cpuCount: cpus.length,\n    cpuModel: cpus.length ? cpus[0].model : null,\n    cpuSpeed: cpus.length ? cpus[0].speed : null,\n    memoryInMb: Math.trunc(os.totalmem() / Math.pow(1024, 2)),\n    // Environment information\n    isDocker: isDockerFunction(),\n    isNowDev: NOW_REGION === 'dev1',\n    isWsl: isWslBoolean,\n    isCI: ciEnvironment.isCI,\n    ciName: (ciEnvironment.isCI && ciEnvironment.name) || null,\n    nextVersion: process.env.__NEXT_VERSION as string,\n  }\n\n  return traits\n}\n"],"names":[],"mappings":";;;;QAwBgB,gBAAgB,GAAhB,gBAAgB;AAxBH,GAA8B,CAA9B,SAA8B;AAClC,GAA2B,CAA3B,MAA2B;AACrC,GAAI,CAAJ,GAAI;AAEP,GAAa,CAAb,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkBzB,GAAG,CAAC,MAAM;SAEM,gBAAgB,GAAkB,CAAC;IACjD,EAAE,EAAE,MAAM,EAAE,CAAC;eACJ,MAAM;IACf,CAAC;IAED,KAAK,CAAC,IAAI,GA3BG,GAAI,SA2BD,IAAI;IACpB,KAAK,GAAG,UAAU,MAAK,OAAO,CAAC,GAAG;IAClC,MAAM;QACJ,EAAuB,AAAvB,qBAAuB;QACvB,cAAc,EA/BH,GAAI,SA+BI,QAAQ;QAC3B,aAAa,EAhCF,GAAI,SAgCG,OAAO;QACzB,kBAAkB,EAjCP,GAAI,SAiCQ,IAAI;QAC3B,EAAsB,AAAtB,oBAAsB;QACtB,QAAQ,EAAE,IAAI,CAAC,MAAM;QACrB,QAAQ,EAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI;QAC5C,QAAQ,EAAE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,EAAE,KAAK,GAAG,IAAI;QAC5C,UAAU,EAAE,IAAI,CAAC,KAAK,CAtCX,GAAI,SAsCW,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;QACvD,EAA0B,AAA1B,wBAA0B;QAC1B,QAAQ,MA1CiB,SAA8B;QA2CvD,QAAQ,EAAE,UAAU,MAAK,IAAM;QAC/B,KAAK,EA3CgB,MAA2B;QA4ChD,IAAI,EAzCI,aAAa,CAyCD,IAAI;QACxB,MAAM,EA1CE,aAAa,CA0CE,IAAI,IA1CnB,aAAa,CA0CwB,IAAI,IAAK,IAAI;QAC1D,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,cAAc;;WAGlC,MAAM;AACf,CAAC"}