{"version":3,"sources":["../../../lib/helpers/get-online.ts"],"sourcesContent":["import { execSync } from 'child_process'\nimport dns from 'dns'\nimport url from 'url'\n\nfunction getProxy(): string | undefined {\n  if (process.env.https_proxy) {\n    return process.env.https_proxy\n  }\n\n  try {\n    const httpsProxy = execSync('npm config get https-proxy').toString().trim()\n    return httpsProxy !== 'null' ? httpsProxy : undefined\n  } catch (e) {\n    return\n  }\n}\n\nexport function getOnline(): Promise<boolean> {\n  return new Promise((resolve) => {\n    dns.lookup('registry.yarnpkg.com', (registryErr) => {\n      if (!registryErr) {\n        return resolve(true)\n      }\n\n      const proxy = getProxy()\n      if (!proxy) {\n        return resolve(false)\n      }\n\n      const { hostname } = url.parse(proxy)\n      if (!hostname) {\n        return resolve(false)\n      }\n\n      dns.lookup(hostname, (proxyErr) => {\n        resolve(proxyErr == null)\n      })\n    })\n  })\n}\n"],"names":[],"mappings":";;;;QAiBgB,SAAS,GAAT,SAAS;AAjBA,GAAe,CAAf,aAAe;AACxB,GAAK,CAAL,IAAK;AACL,GAAK,CAAL,IAAK;;;;;;SAEZ,QAAQ,GAAuB,CAAC;IACvC,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,CAAC;eACrB,OAAO,CAAC,GAAG,CAAC,WAAW;IAChC,CAAC;QAEG,CAAC;QACH,KAAK,CAAC,UAAU,OAVK,aAAe,YAUR,0BAA4B,GAAE,QAAQ,GAAG,IAAI;eAClE,UAAU,MAAK,IAAM,IAAG,UAAU,GAAG,SAAS;IACvD,CAAC,QAAQ,CAAC,EAAE,CAAC;;IAEb,CAAC;AACH,CAAC;SAEe,SAAS,GAAqB,CAAC;WACtC,GAAG,CAAC,OAAO,EAAE,OAAO,GAAK,CAAC;QAjBnB,IAAK,SAkBb,MAAM,EAAC,oBAAsB,IAAG,WAAW,GAAK,CAAC;YACnD,EAAE,GAAG,WAAW,EAAE,CAAC;uBACV,OAAO,CAAC,IAAI;YACrB,CAAC;YAED,KAAK,CAAC,KAAK,GAAG,QAAQ;YACtB,EAAE,GAAG,KAAK,EAAE,CAAC;uBACJ,OAAO,CAAC,KAAK;YACtB,CAAC;YAED,KAAK,GAAG,QAAQ,MA3BN,IAAK,SA2BU,KAAK,CAAC,KAAK;YACpC,EAAE,GAAG,QAAQ,EAAE,CAAC;uBACP,OAAO,CAAC,KAAK;YACtB,CAAC;YA/BS,IAAK,SAiCX,MAAM,CAAC,QAAQ,GAAG,QAAQ,GAAK,CAAC;gBAClC,OAAO,CAAC,QAAQ,IAAI,IAAI;YAC1B,CAAC;QACH,CAAC;IACH,CAAC;AACH,CAAC"}