{"version":3,"sources":["../../lib/find-config.ts"],"sourcesContent":["import findUp from 'next/dist/compiled/find-up'\nimport fs from 'fs'\nimport JSON5 from 'next/dist/compiled/json5'\n\ntype RecursivePartial<T> = {\n  [P in keyof T]?: RecursivePartial<T[P]>\n}\n\n// We'll allow configuration to be typed, but we force everything provided to\n// become optional. We do not perform any schema validation. We should maybe\n// force all the types to be `unknown` as well.\nexport async function findConfig<T>(\n  directory: string,\n  key: string\n): Promise<RecursivePartial<T> | null> {\n  // `package.json` configuration always wins. Let's check that first.\n  const packageJsonPath = await findUp('package.json', { cwd: directory })\n  if (packageJsonPath) {\n    const packageJson = require(packageJsonPath)\n    if (packageJson[key] != null && typeof packageJson[key] === 'object') {\n      return packageJson[key]\n    }\n  }\n\n  // If we didn't find the configuration in `package.json`, we should look for\n  // known filenames.\n  const filePath = await findUp(\n    [\n      `.${key}rc.json`,\n      `${key}.config.json`,\n      `.${key}rc.js`,\n      `${key}.config.js`,\n    ],\n    {\n      cwd: directory,\n    }\n  )\n  if (filePath) {\n    if (filePath.endsWith('.js')) {\n      return require(filePath)\n    }\n\n    // We load JSON contents with JSON5 to allow users to comment in their\n    // configuration file. This pattern was popularized by TypeScript.\n    const fileContents = fs.readFileSync(filePath, 'utf8')\n    return JSON5.parse(fileContents)\n  }\n\n  return null\n}\n"],"names":[],"mappings":";;;;QAWsB,UAAU,GAAV,UAAU;AAXb,GAA4B,CAA5B,OAA4B;AAChC,GAAI,CAAJ,GAAI;AACD,GAA0B,CAA1B,MAA0B;;;;;;eAStB,UAAU,CAC9B,SAAiB,EACjB,GAAW,EAC0B,CAAC;IACtC,EAAoE,AAApE,kEAAoE;IACpE,KAAK,CAAC,eAAe,aAhBJ,OAA4B,WAgBR,YAAc;QAAI,GAAG,EAAE,SAAS;;IACrE,EAAE,EAAE,eAAe,EAAE,CAAC;QACpB,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC,eAAe;QAC3C,EAAE,EAAE,WAAW,CAAC,GAAG,KAAK,IAAI,WAAW,WAAW,CAAC,GAAG,OAAM,MAAQ,GAAE,CAAC;mBAC9D,WAAW,CAAC,GAAG;QACxB,CAAC;IACH,CAAC;IAED,EAA4E,AAA5E,0EAA4E;IAC5E,EAAmB,AAAnB,iBAAmB;IACnB,KAAK,CAAC,QAAQ,aA1BG,OAA4B;SA4BxC,CAAC,EAAE,GAAG,CAAC,OAAO;WACZ,GAAG,CAAC,YAAY;SAClB,CAAC,EAAE,GAAG,CAAC,KAAK;WACV,GAAG,CAAC,UAAU;;QAGjB,GAAG,EAAE,SAAS;;IAGlB,EAAE,EAAE,QAAQ,EAAE,CAAC;QACb,EAAE,EAAE,QAAQ,CAAC,QAAQ,EAAC,GAAK,IAAG,CAAC;mBACtB,OAAO,CAAC,QAAQ;QACzB,CAAC;QAED,EAAsE,AAAtE,oEAAsE;QACtE,EAAkE,AAAlE,gEAAkE;QAClE,KAAK,CAAC,YAAY,GA3CP,GAAI,SA2CS,YAAY,CAAC,QAAQ,GAAE,IAAM;eA1CvC,MAA0B,SA2C3B,KAAK,CAAC,YAAY;IACjC,CAAC;WAEM,IAAI;AACb,CAAC"}